
### 4.3.3 区间逐次分半求积法

好的，这是图片内容的 Markdown 版本。

---

**§ 3 Composite Quadrature**

对于辛普森公式，若 $f^{(4)}(x)$ 在 $[a, b]$ 上连续且变化不大，有
$$I \approx S_{2n} + \frac{1}{15}(S_{2n}-S_n) = S_{2n} + \frac{1}{2^4-1}(S_{2n}-S_n)$$

对于柯特斯公式，若 $f^{(6)}(x)$ 在 $[a, b]$ 上连续且变化不大，有
$$I \approx C_{2n} + \frac{1}{63}(C_{2n}-C_n) = C_{2n} + \frac{1}{2^6-1}(C_{2n}-C_n)$$

---

* **例** 若要求用辛普森方法计算积分 $I = \int_0^1 \frac{\sin x}{x} dx$ 的近似值，使误差不超过 $\frac{1}{2} \times 10^{-6}$。 ($I=0.9460831$)

    **解** 可先算出 $S_1 = 0.9461459$，然后将区间分半（即二等分），并计算 $S_2 = 0.9460869$，显然 $S_2$ 不合要求，故再次将区间分半（即四等分），并计算 $S_4 = 0.9460833$，因为
    $$|S_4 - S_2| < \frac{15}{2} \times 10^{-6}$$
    故 $S_4 = 0.9460833$ 是满足精度要求的近似解。

## 4.4 龙贝格算法

好的，这是图片内容的 Markdown 版本。

---

### **§ 4 龙贝格 (Romberg) 算法**

#### **梯形法的递推化**

将积分区间 **[a, b]** n等分，则一共有 **n+1** 个分点，按梯形公式计算的近似值为 $T_n$。将求积区间再二分一次，则分点增至 **2n+1** 个，其中老分点 **n+1** 个，为避免计算中的重复，$T_{2n}$ 的式子改造如下：

$$T_{2n} = \frac{b-a}{4n} \left[ f(a) + 2\sum_{k=1}^{2n-1} f\left(a+k\frac{b-a}{2n}\right) + f(b) \right]$$

注意到分点 $x_k = a+k\frac{b-a}{2n} \quad (k=1,2,\dots,2n-1)$

$$T_{2n} = \frac{b-a}{4n} \left[ f(a) + 2\sum_{k=1}^{n-1} f\left(a+2k\frac{b-a}{2n}\right) + f(b) + 2\sum_{k=1}^{n} f\left(a+(2k-1)\frac{b-a}{2n}\right) \right]$$

* (注解指向第一个 $\sum$): **当 k 取偶数时是“老分点”**
* (注解指向第二个 $\sum$): **当 k 取奇数时是新增加的分点**



好的，这是图片内容的 Markdown 版本。

---

**§ 4 Romberg Integration**

#### **理查德森外推法 / Richardson's extrapolation**

> Ⓒ 利用低阶公式产生高精度的结果。

设对于某一 $h \ne 0$，有公式 $T_0(h)$ 近似计算某一未知值 $I$。由 Taylor 展开得到：
$$T_0(h) - I = \alpha_1 h + \alpha_2 h^2 + \alpha_3 h^3 + \dots$$

现将 $h$ 对分，得：
$$T_0\left(\frac{h}{2}\right) - I = \alpha_1 \left(\frac{h}{2}\right) + \alpha_2 \left(\frac{h}{2}\right)^2 + \alpha_3 \left(\frac{h}{2}\right)^3 + \dots$$

**Q：如何将公式精度由 $O(h)$ 提高到 $O(h^2)$？**

$$\frac{2T_0(\frac{h}{2}) - T_0(h)}{2-1} - I = -\frac{1}{2}\alpha_2 h^2 - \frac{3}{4}\alpha_3 h^3 - \dots$$

即：
$$T_1(h) = \frac{2T_0(\frac{h}{2}) - T_0(h)}{2-1} = I + \beta_1 h^2 + \beta_2 h^3 + \dots$$

$$T_2(h) = \frac{2^2 T_1(\frac{h}{2}) - T_1(h)}{2^2-1} = I + \gamma_1 h^3 + \gamma_2 h^4 + \dots$$

$$\implies T_m(h) = \frac{2^m T_{m-1}(\frac{h}{2}) - T_{m-1}(h)}{2^m-1} = I + \delta_1 h^{m+1} + \delta_2 h^{m+2} + \dots$$


